<html>
<head>
<title>langchain.ipynb</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #bcbec4;}
.s1 { color: #bcbec4;}
.s2 { color: #6aab73;}
.s3 { color: #cf8e6d;}
.s4 { color: #2aacb8;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
langchain.ipynb</font>
</center></td></tr></table>
<pre><span class="s0">{</span>
 <span class="s2">&quot;cells&quot;</span><span class="s0">: [</span>
  <span class="s0">{</span>
   <span class="s2">&quot;cell_type&quot;</span><span class="s0">: </span><span class="s2">&quot;code&quot;</span><span class="s0">,</span>
   <span class="s2">&quot;metadata&quot;</span><span class="s0">: {</span>
    <span class="s2">&quot;ExecuteTime&quot;</span><span class="s0">: {</span>
     <span class="s2">&quot;end_time&quot;</span><span class="s0">: </span><span class="s2">&quot;2024-08-22T14:11:59.905378Z&quot;</span><span class="s0">,</span>
     <span class="s2">&quot;start_time&quot;</span><span class="s0">: </span><span class="s2">&quot;2024-08-22T14:11:57.207963Z&quot;</span>
    <span class="s0">}</span>
   <span class="s0">},</span>
   <span class="s2">&quot;source&quot;</span><span class="s0">: [</span>
    <span class="s2">&quot;import ssl</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;ssl._create_default_https_context = ssl._create_unverified_context</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;import nltk</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;from langchain_community.document_loaders import DirectoryLoader</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;from dotenv import load_dotenv</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;import os</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;# Загрузка необходимого ресурса для NLTK</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;nltk.download('punkt')</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;# Загрузка переменных окружения</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;load_dotenv()</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;# Инициализация загрузчика</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;loader = DirectoryLoader('data', glob=</span><span class="s3">\&quot;</span><span class="s2">**/*.txt</span><span class="s3">\&quot;</span><span class="s2">)</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;# Загрузка документов</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;documents = loader.load()</span><span class="s3">\n</span><span class="s2">&quot;</span>
   <span class="s0">],</span>
   <span class="s2">&quot;outputs&quot;</span><span class="s0">: [</span>
    <span class="s0">{</span>
     <span class="s2">&quot;name&quot;</span><span class="s0">: </span><span class="s2">&quot;stderr&quot;</span><span class="s0">,</span>
     <span class="s2">&quot;output_type&quot;</span><span class="s0">: </span><span class="s2">&quot;stream&quot;</span><span class="s0">,</span>
     <span class="s2">&quot;text&quot;</span><span class="s0">: [</span>
      <span class="s2">&quot;[nltk_data] Downloading package punkt to /Users/master/nltk_data...</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
      <span class="s2">&quot;[nltk_data]   Package punkt is already up-to-date!</span><span class="s3">\n</span><span class="s2">&quot;</span>
     <span class="s0">]</span>
    <span class="s0">}</span>
   <span class="s0">],</span>
   <span class="s2">&quot;execution_count&quot;</span><span class="s0">: </span><span class="s4">1</span>
  <span class="s0">},</span>
  <span class="s0">{</span>
   <span class="s2">&quot;cell_type&quot;</span><span class="s0">: </span><span class="s2">&quot;code&quot;</span><span class="s0">,</span>
   <span class="s2">&quot;metadata&quot;</span><span class="s0">: {</span>
    <span class="s2">&quot;ExecuteTime&quot;</span><span class="s0">: {</span>
     <span class="s2">&quot;end_time&quot;</span><span class="s0">: </span><span class="s2">&quot;2024-08-22T14:12:01.640058Z&quot;</span><span class="s0">,</span>
     <span class="s2">&quot;start_time&quot;</span><span class="s0">: </span><span class="s2">&quot;2024-08-22T14:12:01.636335Z&quot;</span>
    <span class="s0">}</span>
   <span class="s0">},</span>
   <span class="s2">&quot;source&quot;</span><span class="s0">: [</span>
    <span class="s2">&quot;print(documents)</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;print(documents[0].page_content)&quot;</span>
   <span class="s0">],</span>
   <span class="s2">&quot;outputs&quot;</span><span class="s0">: [</span>
    <span class="s0">{</span>
     <span class="s2">&quot;name&quot;</span><span class="s0">: </span><span class="s2">&quot;stdout&quot;</span><span class="s0">,</span>
     <span class="s2">&quot;output_type&quot;</span><span class="s0">: </span><span class="s2">&quot;stream&quot;</span><span class="s0">,</span>
     <span class="s2">&quot;text&quot;</span><span class="s0">: [</span>
      <span class="s2">&quot;[Document(page_content='Q: Какими бывают кукусики?</span><span class="s3">\\</span><span class="s2">n</span><span class="s3">\\</span><span class="s2">nA: Кукусики бывают фельдепёрстовые.</span><span class="s3">\\</span><span class="s2">n</span><span class="s3">\\</span><span class="s2">nQ: Что делает нашу пиццу уникальной? A: Наша пицца готовится по секретному семейному рецепту теста, вручную раскатывается и украшается свежими, местными ингредиентами. Мы используем традиционную дровяную печь, чтобы придать пицце характерный дымный вкус и хрустящую корочку.</span><span class="s3">\\</span><span class="s2">n</span><span class="s3">\\</span><span class="s2">nQ: Предлагаем ли мы варианты пиццы без глютена? A: Да, у нас есть вкусная безглютеновая корочка для гостей с диетическими ограничениями или предпочтениями.</span><span class="s3">\\</span><span class="s2">n</span><span class="s3">\\</span><span class="s2">nQ: Могут ли клиенты создать свою собственную пиццу? A: Конечно! Клиенты могут выбрать из множества свежих топпингов, чтобы создать свою уникальную пиццу-шедевр.</span><span class="s3">\\</span><span class="s2">n</span><span class="s3">\\</span><span class="s2">nQ: Какие наши самые популярные пиццы? A: Наши самые популярные пиццы — это Классическая Маргарита, Пепперони Суприм и Гурман Вегетарианская. Каждая из них предлагает уникальное сочетание вкусов, которое удовлетворяет разнообразные предпочтения.</span><span class="s3">\\</span><span class="s2">n</span><span class="s3">\\</span><span class="s2">nQ: Предлагаем ли мы веганские варианты пиццы? A: Да, у нас есть веганские пиццы, которые включают сыр без молочных продуктов и разнообразные свежие овощные топпинги.</span><span class="s3">\\</span><span class="s2">n</span><span class="s3">\\</span><span class="s2">nQ: Сколько времени занимает приготовление пиццы? A: В среднем, от момента заказа до готовности пиццы проходит около 15-20 минут. Это время необходимо, чтобы каждая пицца была идеально приготовлена.</span><span class="s3">\\</span><span class="s2">n</span><span class="s3">\\</span><span class="s2">nQ: Можно ли заказать пиццу на доставку? A: Да, мы предлагаем доставку в пределах определенного радиуса от нашего ресторана, чтобы вы могли наслаждаться нашей пиццей, не выходя из дома.</span><span class="s3">\\</span><span class="s2">n</span><span class="s3">\\</span><span class="s2">nQ: Какими бывают рештальдовые кукусики? A: Рештальдовые кукусики бывают исключительно калдобровсчатыми.', metadata={'source': 'data/text.txt'})]</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
      <span class="s2">&quot;Q: Какими бывают кукусики?</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
      <span class="s2">&quot;</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
      <span class="s2">&quot;A: Кукусики бывают фельдепёрстовые.</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
      <span class="s2">&quot;</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
      <span class="s2">&quot;Q: Что делает нашу пиццу уникальной? A: Наша пицца готовится по секретному семейному рецепту теста, вручную раскатывается и украшается свежими, местными ингредиентами. Мы используем традиционную дровяную печь, чтобы придать пицце характерный дымный вкус и хрустящую корочку.</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
      <span class="s2">&quot;</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
      <span class="s2">&quot;Q: Предлагаем ли мы варианты пиццы без глютена? A: Да, у нас есть вкусная безглютеновая корочка для гостей с диетическими ограничениями или предпочтениями.</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
      <span class="s2">&quot;</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
      <span class="s2">&quot;Q: Могут ли клиенты создать свою собственную пиццу? A: Конечно! Клиенты могут выбрать из множества свежих топпингов, чтобы создать свою уникальную пиццу-шедевр.</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
      <span class="s2">&quot;</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
      <span class="s2">&quot;Q: Какие наши самые популярные пиццы? A: Наши самые популярные пиццы — это Классическая Маргарита, Пепперони Суприм и Гурман Вегетарианская. Каждая из них предлагает уникальное сочетание вкусов, которое удовлетворяет разнообразные предпочтения.</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
      <span class="s2">&quot;</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
      <span class="s2">&quot;Q: Предлагаем ли мы веганские варианты пиццы? A: Да, у нас есть веганские пиццы, которые включают сыр без молочных продуктов и разнообразные свежие овощные топпинги.</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
      <span class="s2">&quot;</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
      <span class="s2">&quot;Q: Сколько времени занимает приготовление пиццы? A: В среднем, от момента заказа до готовности пиццы проходит около 15-20 минут. Это время необходимо, чтобы каждая пицца была идеально приготовлена.</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
      <span class="s2">&quot;</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
      <span class="s2">&quot;Q: Можно ли заказать пиццу на доставку? A: Да, мы предлагаем доставку в пределах определенного радиуса от нашего ресторана, чтобы вы могли наслаждаться нашей пиццей, не выходя из дома.</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
      <span class="s2">&quot;</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
      <span class="s2">&quot;Q: Какими бывают рештальдовые кукусики? A: Рештальдовые кукусики бывают исключительно калдобровсчатыми.</span><span class="s3">\n</span><span class="s2">&quot;</span>
     <span class="s0">]</span>
    <span class="s0">}</span>
   <span class="s0">],</span>
   <span class="s2">&quot;execution_count&quot;</span><span class="s0">: </span><span class="s4">2</span>
  <span class="s0">},</span>
  <span class="s0">{</span>
   <span class="s2">&quot;cell_type&quot;</span><span class="s0">: </span><span class="s2">&quot;code&quot;</span><span class="s0">,</span>
   <span class="s2">&quot;metadata&quot;</span><span class="s0">: {</span>
    <span class="s2">&quot;ExecuteTime&quot;</span><span class="s0">: {</span>
     <span class="s2">&quot;end_time&quot;</span><span class="s0">: </span><span class="s2">&quot;2024-08-22T14:12:04.603780Z&quot;</span><span class="s0">,</span>
     <span class="s2">&quot;start_time&quot;</span><span class="s0">: </span><span class="s2">&quot;2024-08-22T14:12:04.599897Z&quot;</span>
    <span class="s0">}</span>
   <span class="s0">},</span>
   <span class="s2">&quot;source&quot;</span><span class="s0">: [</span>
    <span class="s2">&quot;from langchain.text_splitter import CharacterTextSplitter</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;text_splitter = CharacterTextSplitter(</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;    separator=</span><span class="s3">\&quot;\\</span><span class="s2">n</span><span class="s3">\\</span><span class="s2">n</span><span class="s3">\&quot;</span><span class="s2">,</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;    chunk_size=250,</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;    chunk_overlap=10,</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;    length_function=len,</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;    is_separator_regex=False,</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;)&quot;</span>
   <span class="s0">],</span>
   <span class="s2">&quot;outputs&quot;</span><span class="s0">: [],</span>
   <span class="s2">&quot;execution_count&quot;</span><span class="s0">: </span><span class="s4">3</span>
  <span class="s0">},</span>
  <span class="s0">{</span>
   <span class="s2">&quot;cell_type&quot;</span><span class="s0">: </span><span class="s2">&quot;code&quot;</span><span class="s0">,</span>
   <span class="s2">&quot;metadata&quot;</span><span class="s0">: {</span>
    <span class="s2">&quot;ExecuteTime&quot;</span><span class="s0">: {</span>
     <span class="s2">&quot;end_time&quot;</span><span class="s0">: </span><span class="s2">&quot;2024-08-22T14:12:07.734159Z&quot;</span><span class="s0">,</span>
     <span class="s2">&quot;start_time&quot;</span><span class="s0">: </span><span class="s2">&quot;2024-08-22T14:12:07.724407Z&quot;</span>
    <span class="s0">}</span>
   <span class="s0">},</span>
   <span class="s2">&quot;source&quot;</span><span class="s0">: [</span>
    <span class="s2">&quot;chunks = text_splitter.split_documents(documents)</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;chunks&quot;</span>
   <span class="s0">],</span>
   <span class="s2">&quot;outputs&quot;</span><span class="s0">: [</span>
    <span class="s0">{</span>
     <span class="s2">&quot;name&quot;</span><span class="s0">: </span><span class="s2">&quot;stderr&quot;</span><span class="s0">,</span>
     <span class="s2">&quot;output_type&quot;</span><span class="s0">: </span><span class="s2">&quot;stream&quot;</span><span class="s0">,</span>
     <span class="s2">&quot;text&quot;</span><span class="s0">: [</span>
      <span class="s2">&quot;Created a chunk of size 274, which is longer than the specified 250</span><span class="s3">\n</span><span class="s2">&quot;</span>
     <span class="s0">]</span>
    <span class="s0">},</span>
    <span class="s0">{</span>
     <span class="s2">&quot;data&quot;</span><span class="s0">: {</span>
      <span class="s2">&quot;text/plain&quot;</span><span class="s0">: [</span>
       <span class="s2">&quot;[Document(page_content='Q: Какими бывают кукусики?</span><span class="s3">\\</span><span class="s2">n</span><span class="s3">\\</span><span class="s2">nA: Кукусики бывают фельдепёрстовые.', metadata={'source': 'data/text.txt'}),</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
       <span class="s2">&quot; Document(page_content='Q: Что делает нашу пиццу уникальной? A: Наша пицца готовится по секретному семейному рецепту теста, вручную раскатывается и украшается свежими, местными ингредиентами. Мы используем традиционную дровяную печь, чтобы придать пицце характерный дымный вкус и хрустящую корочку.', metadata={'source': 'data/text.txt'}),</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
       <span class="s2">&quot; Document(page_content='Q: Предлагаем ли мы варианты пиццы без глютена? A: Да, у нас есть вкусная безглютеновая корочка для гостей с диетическими ограничениями или предпочтениями.', metadata={'source': 'data/text.txt'}),</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
       <span class="s2">&quot; Document(page_content='Q: Могут ли клиенты создать свою собственную пиццу? A: Конечно! Клиенты могут выбрать из множества свежих топпингов, чтобы создать свою уникальную пиццу-шедевр.', metadata={'source': 'data/text.txt'}),</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
       <span class="s2">&quot; Document(page_content='Q: Какие наши самые популярные пиццы? A: Наши самые популярные пиццы — это Классическая Маргарита, Пепперони Суприм и Гурман Вегетарианская. Каждая из них предлагает уникальное сочетание вкусов, которое удовлетворяет разнообразные предпочтения.', metadata={'source': 'data/text.txt'}),</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
       <span class="s2">&quot; Document(page_content='Q: Предлагаем ли мы веганские варианты пиццы? A: Да, у нас есть веганские пиццы, которые включают сыр без молочных продуктов и разнообразные свежие овощные топпинги.', metadata={'source': 'data/text.txt'}),</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
       <span class="s2">&quot; Document(page_content='Q: Сколько времени занимает приготовление пиццы? A: В среднем, от момента заказа до готовности пиццы проходит около 15-20 минут. Это время необходимо, чтобы каждая пицца была идеально приготовлена.', metadata={'source': 'data/text.txt'}),</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
       <span class="s2">&quot; Document(page_content='Q: Можно ли заказать пиццу на доставку? A: Да, мы предлагаем доставку в пределах определенного радиуса от нашего ресторана, чтобы вы могли наслаждаться нашей пиццей, не выходя из дома.', metadata={'source': 'data/text.txt'}),</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
       <span class="s2">&quot; Document(page_content='Q: Какими бывают рештальдовые кукусики? A: Рештальдовые кукусики бывают исключительно калдобровсчатыми.', metadata={'source': 'data/text.txt'})]&quot;</span>
      <span class="s0">]</span>
     <span class="s0">},</span>
     <span class="s2">&quot;execution_count&quot;</span><span class="s0">: </span><span class="s4">4</span><span class="s0">,</span>
     <span class="s2">&quot;metadata&quot;</span><span class="s0">: {},</span>
     <span class="s2">&quot;output_type&quot;</span><span class="s0">: </span><span class="s2">&quot;execute_result&quot;</span>
    <span class="s0">}</span>
   <span class="s0">],</span>
   <span class="s2">&quot;execution_count&quot;</span><span class="s0">: </span><span class="s4">4</span>
  <span class="s0">},</span>
  <span class="s0">{</span>
   <span class="s2">&quot;metadata&quot;</span><span class="s0">: {},</span>
   <span class="s2">&quot;cell_type&quot;</span><span class="s0">: </span><span class="s2">&quot;markdown&quot;</span><span class="s0">,</span>
   <span class="s2">&quot;source&quot;</span><span class="s0">: </span><span class="s2">&quot;&quot;</span>
  <span class="s0">},</span>
  <span class="s0">{</span>
   <span class="s2">&quot;cell_type&quot;</span><span class="s0">: </span><span class="s2">&quot;code&quot;</span><span class="s0">,</span>
   <span class="s2">&quot;metadata&quot;</span><span class="s0">: {</span>
    <span class="s2">&quot;ExecuteTime&quot;</span><span class="s0">: {</span>
     <span class="s2">&quot;end_time&quot;</span><span class="s0">: </span><span class="s2">&quot;2024-08-22T14:12:11.864431Z&quot;</span><span class="s0">,</span>
     <span class="s2">&quot;start_time&quot;</span><span class="s0">: </span><span class="s2">&quot;2024-08-22T14:12:10.253932Z&quot;</span>
    <span class="s0">}</span>
   <span class="s0">},</span>
   <span class="s2">&quot;source&quot;</span><span class="s0">: [</span>
    <span class="s2">&quot;from langchain_openai import OpenAIEmbeddings</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;from langchain_community.vectorstores import Chroma</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;index = Chroma.from_documents(chunks, OpenAIEmbeddings())&quot;</span>
   <span class="s0">],</span>
   <span class="s2">&quot;outputs&quot;</span><span class="s0">: [],</span>
   <span class="s2">&quot;execution_count&quot;</span><span class="s0">: </span><span class="s4">5</span>
  <span class="s0">},</span>
  <span class="s0">{</span>
   <span class="s2">&quot;cell_type&quot;</span><span class="s0">: </span><span class="s2">&quot;code&quot;</span><span class="s0">,</span>
   <span class="s2">&quot;metadata&quot;</span><span class="s0">: {</span>
    <span class="s2">&quot;ExecuteTime&quot;</span><span class="s0">: {</span>
     <span class="s2">&quot;end_time&quot;</span><span class="s0">: </span><span class="s2">&quot;2024-08-22T14:12:13.555402Z&quot;</span><span class="s0">,</span>
     <span class="s2">&quot;start_time&quot;</span><span class="s0">: </span><span class="s2">&quot;2024-08-22T14:12:13.551062Z&quot;</span>
    <span class="s0">}</span>
   <span class="s0">},</span>
   <span class="s2">&quot;source&quot;</span><span class="s0">: [</span>
    <span class="s2">&quot;retriever = index.as_retriever()&quot;</span>
   <span class="s0">],</span>
   <span class="s2">&quot;outputs&quot;</span><span class="s0">: [],</span>
   <span class="s2">&quot;execution_count&quot;</span><span class="s0">: </span><span class="s4">6</span>
  <span class="s0">},</span>
  <span class="s0">{</span>
   <span class="s2">&quot;cell_type&quot;</span><span class="s0">: </span><span class="s2">&quot;code&quot;</span><span class="s0">,</span>
   <span class="s2">&quot;metadata&quot;</span><span class="s0">: {</span>
    <span class="s2">&quot;ExecuteTime&quot;</span><span class="s0">: {</span>
     <span class="s2">&quot;end_time&quot;</span><span class="s0">: </span><span class="s2">&quot;2024-08-22T14:12:15.815700Z&quot;</span><span class="s0">,</span>
     <span class="s2">&quot;start_time&quot;</span><span class="s0">: </span><span class="s2">&quot;2024-08-22T14:12:15.545599Z&quot;</span>
    <span class="s0">}</span>
   <span class="s0">},</span>
   <span class="s2">&quot;source&quot;</span><span class="s0">: </span><span class="s2">&quot;retriever.get_relevant_documents(</span><span class="s3">\&quot;</span><span class="s2">Какими бывают кукусики</span><span class="s3">\&quot;</span><span class="s2">)&quot;</span><span class="s0">,</span>
   <span class="s2">&quot;outputs&quot;</span><span class="s0">: [</span>
    <span class="s0">{</span>
     <span class="s2">&quot;data&quot;</span><span class="s0">: {</span>
      <span class="s2">&quot;text/plain&quot;</span><span class="s0">: [</span>
       <span class="s2">&quot;[Document(page_content='Q: Какими бывают кукусики?</span><span class="s3">\\</span><span class="s2">n</span><span class="s3">\\</span><span class="s2">nA: Кукусики бывают фельдепёрстовые.', metadata={'source': 'data/text.txt'}),</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
       <span class="s2">&quot; Document(page_content='Q: Какими бывают рештальдовые кукусики? A: Рештальдовые кукусики бывают исключительно калдобровсчатыми.', metadata={'source': 'data/text.txt'}),</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
       <span class="s2">&quot; Document(page_content='Q: Какие наши самые популярные пиццы? A: Наши самые популярные пиццы — это Классическая Маргарита, Пепперони Суприм и Гурман Вегетарианская. Каждая из них предлагает уникальное сочетание вкусов, которое удовлетворяет разнообразные предпочтения.', metadata={'source': 'data/text.txt'}),</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
       <span class="s2">&quot; Document(page_content='Q: Что делает нашу пиццу уникальной? A: Наша пицца готовится по секретному семейному рецепту теста, вручную раскатывается и украшается свежими, местными ингредиентами. Мы используем традиционную дровяную печь, чтобы придать пицце характерный дымный вкус и хрустящую корочку.', metadata={'source': 'data/text.txt'})]&quot;</span>
      <span class="s0">]</span>
     <span class="s0">},</span>
     <span class="s2">&quot;execution_count&quot;</span><span class="s0">: </span><span class="s4">7</span><span class="s0">,</span>
     <span class="s2">&quot;metadata&quot;</span><span class="s0">: {},</span>
     <span class="s2">&quot;output_type&quot;</span><span class="s0">: </span><span class="s2">&quot;execute_result&quot;</span>
    <span class="s0">}</span>
   <span class="s0">],</span>
   <span class="s2">&quot;execution_count&quot;</span><span class="s0">: </span><span class="s4">7</span>
  <span class="s0">},</span>
  <span class="s0">{</span>
   <span class="s2">&quot;cell_type&quot;</span><span class="s0">: </span><span class="s2">&quot;code&quot;</span><span class="s0">,</span>
   <span class="s2">&quot;metadata&quot;</span><span class="s0">: {</span>
    <span class="s2">&quot;ExecuteTime&quot;</span><span class="s0">: {</span>
     <span class="s2">&quot;end_time&quot;</span><span class="s0">: </span><span class="s2">&quot;2024-08-22T14:12:18.609060Z&quot;</span><span class="s0">,</span>
     <span class="s2">&quot;start_time&quot;</span><span class="s0">: </span><span class="s2">&quot;2024-08-22T14:12:18.606082Z&quot;</span>
    <span class="s0">}</span>
   <span class="s0">},</span>
   <span class="s2">&quot;source&quot;</span><span class="s0">: [</span>
    <span class="s2">&quot;from operator import itemgetter</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;template = </span><span class="s3">\&quot;\&quot;\&quot;\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;Ответь на вопрос используя следующий контекст:</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;{context}</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;Ответь на этот вопрос:</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;Вопрос: {question}</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;</span><span class="s3">\&quot;\&quot;\&quot;</span><span class="s2">&quot;</span>
   <span class="s0">],</span>
   <span class="s2">&quot;outputs&quot;</span><span class="s0">: [],</span>
   <span class="s2">&quot;execution_count&quot;</span><span class="s0">: </span><span class="s4">8</span>
  <span class="s0">},</span>
  <span class="s0">{</span>
   <span class="s2">&quot;cell_type&quot;</span><span class="s0">: </span><span class="s2">&quot;code&quot;</span><span class="s0">,</span>
   <span class="s2">&quot;metadata&quot;</span><span class="s0">: {</span>
    <span class="s2">&quot;ExecuteTime&quot;</span><span class="s0">: {</span>
     <span class="s2">&quot;end_time&quot;</span><span class="s0">: </span><span class="s2">&quot;2024-08-22T14:12:20.595767Z&quot;</span><span class="s0">,</span>
     <span class="s2">&quot;start_time&quot;</span><span class="s0">: </span><span class="s2">&quot;2024-08-22T14:12:20.548859Z&quot;</span>
    <span class="s0">}</span>
   <span class="s0">},</span>
   <span class="s2">&quot;source&quot;</span><span class="s0">: [</span>
    <span class="s2">&quot;from langchain_core.output_parsers import StrOutputParser</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;from langchain_core.prompts import ChatPromptTemplate</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;from langchain_openai import ChatOpenAI</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;prompt = ChatPromptTemplate.from_template(template)</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;model = ChatOpenAI(model_name=</span><span class="s3">\&quot;</span><span class="s2">gpt-3.5-turbo</span><span class="s3">\&quot;</span><span class="s2">)&quot;</span>
   <span class="s0">],</span>
   <span class="s2">&quot;outputs&quot;</span><span class="s0">: [],</span>
   <span class="s2">&quot;execution_count&quot;</span><span class="s0">: </span><span class="s4">9</span>
  <span class="s0">},</span>
  <span class="s0">{</span>
   <span class="s2">&quot;cell_type&quot;</span><span class="s0">: </span><span class="s2">&quot;code&quot;</span><span class="s0">,</span>
   <span class="s2">&quot;metadata&quot;</span><span class="s0">: {</span>
    <span class="s2">&quot;ExecuteTime&quot;</span><span class="s0">: {</span>
     <span class="s2">&quot;end_time&quot;</span><span class="s0">: </span><span class="s2">&quot;2024-08-22T14:12:22.015663Z&quot;</span><span class="s0">,</span>
     <span class="s2">&quot;start_time&quot;</span><span class="s0">: </span><span class="s2">&quot;2024-08-22T14:12:22.011446Z&quot;</span>
    <span class="s0">}</span>
   <span class="s0">},</span>
   <span class="s2">&quot;source&quot;</span><span class="s0">: [</span>
    <span class="s2">&quot;rag_chain = (</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;    {</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;        </span><span class="s3">\&quot;</span><span class="s2">context</span><span class="s3">\&quot;</span><span class="s2">: itemgetter(</span><span class="s3">\&quot;</span><span class="s2">question</span><span class="s3">\&quot;</span><span class="s2">) | retriever,</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;        </span><span class="s3">\&quot;</span><span class="s2">question</span><span class="s3">\&quot;</span><span class="s2">: itemgetter(</span><span class="s3">\&quot;</span><span class="s2">question</span><span class="s3">\&quot;</span><span class="s2">)</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;    }</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;    | prompt</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;    | model</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;    | StrOutputParser()</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;)&quot;</span>
   <span class="s0">],</span>
   <span class="s2">&quot;outputs&quot;</span><span class="s0">: [],</span>
   <span class="s2">&quot;execution_count&quot;</span><span class="s0">: </span><span class="s4">10</span>
  <span class="s0">},</span>
  <span class="s0">{</span>
   <span class="s2">&quot;cell_type&quot;</span><span class="s0">: </span><span class="s2">&quot;code&quot;</span><span class="s0">,</span>
   <span class="s2">&quot;metadata&quot;</span><span class="s0">: {</span>
    <span class="s2">&quot;ExecuteTime&quot;</span><span class="s0">: {</span>
     <span class="s2">&quot;end_time&quot;</span><span class="s0">: </span><span class="s2">&quot;2024-08-22T14:12:27.792937Z&quot;</span><span class="s0">,</span>
     <span class="s2">&quot;start_time&quot;</span><span class="s0">: </span><span class="s2">&quot;2024-08-22T14:12:26.037502Z&quot;</span>
    <span class="s0">}</span>
   <span class="s0">},</span>
   <span class="s2">&quot;source&quot;</span><span class="s0">: </span><span class="s2">&quot;rag_chain.invoke({</span><span class="s3">\&quot;</span><span class="s2">question</span><span class="s3">\&quot;</span><span class="s2">: </span><span class="s3">\&quot;</span><span class="s2">Какими бывают кукусики</span><span class="s3">\&quot;</span><span class="s2">})&quot;</span><span class="s0">,</span>
   <span class="s2">&quot;outputs&quot;</span><span class="s0">: [</span>
    <span class="s0">{</span>
     <span class="s2">&quot;data&quot;</span><span class="s0">: {</span>
      <span class="s2">&quot;text/plain&quot;</span><span class="s0">: [</span>
       <span class="s2">&quot;'Ответ: Кукусики бывают фельдепёрстовые и рештальдовые, причем рештальдовые кукусики бывают исключительно калдобровсчатыми.'&quot;</span>
      <span class="s0">]</span>
     <span class="s0">},</span>
     <span class="s2">&quot;execution_count&quot;</span><span class="s0">: </span><span class="s4">12</span><span class="s0">,</span>
     <span class="s2">&quot;metadata&quot;</span><span class="s0">: {},</span>
     <span class="s2">&quot;output_type&quot;</span><span class="s0">: </span><span class="s2">&quot;execute_result&quot;</span>
    <span class="s0">}</span>
   <span class="s0">],</span>
   <span class="s2">&quot;execution_count&quot;</span><span class="s0">: </span><span class="s4">12</span>
  <span class="s0">},</span>
  <span class="s0">{</span>
   <span class="s2">&quot;metadata&quot;</span><span class="s0">: {</span>
    <span class="s2">&quot;ExecuteTime&quot;</span><span class="s0">: {</span>
     <span class="s2">&quot;end_time&quot;</span><span class="s0">: </span><span class="s2">&quot;2024-08-22T14:12:31.873274Z&quot;</span><span class="s0">,</span>
     <span class="s2">&quot;start_time&quot;</span><span class="s0">: </span><span class="s2">&quot;2024-08-22T14:12:30.475834Z&quot;</span>
    <span class="s0">}</span>
   <span class="s0">},</span>
   <span class="s2">&quot;cell_type&quot;</span><span class="s0">: </span><span class="s2">&quot;code&quot;</span><span class="s0">,</span>
   <span class="s2">&quot;source&quot;</span><span class="s0">: </span><span class="s2">&quot;rag_chain.invoke({</span><span class="s3">\&quot;</span><span class="s2">question</span><span class="s3">\&quot;</span><span class="s2">: </span><span class="s3">\&quot;</span><span class="s2">Долго готовится пицца?</span><span class="s3">\&quot;</span><span class="s2">})</span><span class="s3">\n</span><span class="s2">&quot;</span><span class="s0">,</span>
   <span class="s2">&quot;outputs&quot;</span><span class="s0">: [</span>
    <span class="s0">{</span>
     <span class="s2">&quot;data&quot;</span><span class="s0">: {</span>
      <span class="s2">&quot;text/plain&quot;</span><span class="s0">: [</span>
       <span class="s2">&quot;'Ответ: В среднем, от момента заказа до готовности пиццы проходит около 15-20 минут.'&quot;</span>
      <span class="s0">]</span>
     <span class="s0">},</span>
     <span class="s2">&quot;execution_count&quot;</span><span class="s0">: </span><span class="s4">13</span><span class="s0">,</span>
     <span class="s2">&quot;metadata&quot;</span><span class="s0">: {},</span>
     <span class="s2">&quot;output_type&quot;</span><span class="s0">: </span><span class="s2">&quot;execute_result&quot;</span>
    <span class="s0">}</span>
   <span class="s0">],</span>
   <span class="s2">&quot;execution_count&quot;</span><span class="s0">: </span><span class="s4">13</span>
  <span class="s0">},</span>
  <span class="s0">{</span>
   <span class="s2">&quot;metadata&quot;</span><span class="s0">: {},</span>
   <span class="s2">&quot;cell_type&quot;</span><span class="s0">: </span><span class="s2">&quot;code&quot;</span><span class="s0">,</span>
   <span class="s2">&quot;outputs&quot;</span><span class="s0">: [],</span>
   <span class="s2">&quot;execution_count&quot;</span><span class="s0">: </span><span class="s3">null</span><span class="s0">,</span>
   <span class="s2">&quot;source&quot;</span><span class="s0">: </span><span class="s2">&quot;&quot;</span>
  <span class="s0">}</span>
 <span class="s0">],</span>
 <span class="s2">&quot;metadata&quot;</span><span class="s0">: {</span>
  <span class="s2">&quot;kernelspec&quot;</span><span class="s0">: {</span>
   <span class="s2">&quot;display_name&quot;</span><span class="s0">: </span><span class="s2">&quot;app&quot;</span><span class="s0">,</span>
   <span class="s2">&quot;language&quot;</span><span class="s0">: </span><span class="s2">&quot;python&quot;</span><span class="s0">,</span>
   <span class="s2">&quot;name&quot;</span><span class="s0">: </span><span class="s2">&quot;python3&quot;</span>
  <span class="s0">},</span>
  <span class="s2">&quot;language_info&quot;</span><span class="s0">: {</span>
   <span class="s2">&quot;codemirror_mode&quot;</span><span class="s0">: {</span>
    <span class="s2">&quot;name&quot;</span><span class="s0">: </span><span class="s2">&quot;ipython&quot;</span><span class="s0">,</span>
    <span class="s2">&quot;version&quot;</span><span class="s0">: </span><span class="s4">3</span>
   <span class="s0">},</span>
   <span class="s2">&quot;file_extension&quot;</span><span class="s0">: </span><span class="s2">&quot;.py&quot;</span><span class="s0">,</span>
   <span class="s2">&quot;mimetype&quot;</span><span class="s0">: </span><span class="s2">&quot;text/x-python&quot;</span><span class="s0">,</span>
   <span class="s2">&quot;name&quot;</span><span class="s0">: </span><span class="s2">&quot;python&quot;</span><span class="s0">,</span>
   <span class="s2">&quot;nbconvert_exporter&quot;</span><span class="s0">: </span><span class="s2">&quot;python&quot;</span><span class="s0">,</span>
   <span class="s2">&quot;pygments_lexer&quot;</span><span class="s0">: </span><span class="s2">&quot;ipython3&quot;</span><span class="s0">,</span>
   <span class="s2">&quot;version&quot;</span><span class="s0">: </span><span class="s2">&quot;3.11.0&quot;</span>
  <span class="s0">}</span>
 <span class="s0">},</span>
 <span class="s2">&quot;nbformat&quot;</span><span class="s0">: </span><span class="s4">4</span><span class="s0">,</span>
 <span class="s2">&quot;nbformat_minor&quot;</span><span class="s0">: </span><span class="s4">2</span>
<span class="s0">}</span>
</pre>
</body>
</html>
